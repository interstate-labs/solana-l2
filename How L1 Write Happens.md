Arbitrum writes to the Ethereum L1 (Layer 1) blockchain primarily through a mechanism called "rollup." In the context of the provided code from the arbnode package, this is managed by components like the BatchPoster. Here's a high-level overview of how this process works:

1. Batching Transactions: Transactions executed on Arbitrum (L2) are batched together. This batching is handled by the BatchPoster component, which collects multiple L2 transactions and prepares them to be posted to Ethereum as a single batch. This reduces the L1 transaction count and hence the overall gas cost.
2. Data Compression: Before posting to L1, the data is often compressed to minimize the size of the data that needs to be stored on Ethereum. This is evident from the use of Brotli compression in the code.
3. Posting to Ethereum: The compressed batch of transactions is then posted to the Ethereum network. This involves interacting with Ethereum smart contracts specifically designed to handle these batches. In the code, this interaction is facilitated through contracts like SequencerInbox and possibly others like Bridge. These contracts receive the batched transactions and record them on the Ethereum blockchain.
4. Sequencer and Inbox: The SequencerInbox contract plays a crucial role as it receives the batches from the Arbitrum sequencer (which orders transactions on L2) and commits them to Ethereum. This ensures that the state of Arbitrum is anchored to the Ethereum main chain at regular intervals.
5. Handling Reverts and Gas Estimations: The system also includes mechanisms to handle potential reverts (transaction failures) and dynamically adjust gas estimations to optimize transaction posting in terms of cost and speed.
6. Monitoring and Metrics: Various metrics are tracked, such as gas usage, batch sizes, and transaction statuses, to monitor the system's performance and make adjustments as needed.
The actual writing to the Ethereum blockchain is done through Ethereum transactions that call smart contract methods, passing the necessary data (the batched transactions) as arguments. These transactions are crafted and sent by the BatchPoster using Ethereum's JSON-RPC API, facilitated by libraries like go-ethereum.
This process ensures that the Arbitrum Layer 2 maintains its security and decentralization by leveraging the underlying Ethereum Layer 1 blockchain.
